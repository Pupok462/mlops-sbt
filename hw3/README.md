# Супер отчет по 3 домашке

----
## perf_analyzer 
- Отдельно лежат  одноименные ```.csv``` отчеты в папке ```perf_analyzer```

### ONNX
![](imgs/perf_onnx.png)

### TRT BEST
![](imgs/perf_trt_best.png)

### TRT FP16
![](imgs/perf_trt_fp16.png)
### TRT FP32
![](imgs/perf_trt_fp32.png)
----
### TRT INT8
![](imgs/perf_trt_int8.png)
----

## Отклонения ~~в в моем развитии~~  эмбеддингов trt от ONNX
- Делаем ```.plan``` файлики 
![](imgs/trtexec.png)
- Делаем сравнение эмбеддингов
![](imgs/trt_onnx_diff.png)
----

## Арифметическая сложность модели

- Есть ноутбук где все считал ```part_one/flops.ipynb```

| Layer | FLOPS (1, 20) batch    | Memory (1,20) batch | FLOPS/Memory (1,20) | Limited  |
|-------|------------------------|---------------------|---------------------|----------|
| Proj  | (344064, 6881280)      | (49216, 984320)     | (6.9, 6.9)          | No (Yes) |
| Dense | (1179648, 23592960)    | (2362368, 47247360) | (0.49, 0.49)        | No (Yes) |
| Tanh  | (0, 0)                 | (6144, 122880)      | (0, 0)              | No       |
| Attn  | (66146304, 1322926080) | (9437184, 188743680)         | (7,  7)             | No (Yes) |
| PE    | (0, 0)                 | (1572864, 31457280) | (0, 0)              | No       |



